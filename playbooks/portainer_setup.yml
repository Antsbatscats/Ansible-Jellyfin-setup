--- 
   - name: Setup portainer
     hosts: all
     become: yes
     tasks: 

      - name: Deploy Portainer
      community.docker.docker_container: 
        name: portainer
        image: portainer/portainer-ce
        ports: 
          - "9000:9000"
          - "8000:8000"
        
        volumes: 
          - /var/run/docker.sock:/var/run/docker.sock
          - portainer_data:/data
        restart_policy: always
      
      - name: Deploy Jellyfin
        community.docker.docker.container: 
          name: Jellyfin
          image: linuxserver/jellyfin
          restart_policy: "unless_stopped"
          restart: yes
          networks: 
            - name: "bridge"
          ports: 
            - "80:80"
            - "7359:7359"
            - "8096:8096"
            - "8920:8920"
          env: 
            PGID: "1000"
            PUID: "1000"
            TZ: "Europe/London"
          volumes: 
            - /home/Jellyfin/Media/Movies:/data/movies
            - /home/Jellyfin/Media/Books:/data/books
            - /home/Jellyfin/Media/Videos:/data/videos
            - /home/Jellyfin/Media/Photos:/data/photos
            - /home/Jellyfin/Config:/config
